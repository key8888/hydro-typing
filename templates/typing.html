{% extends "layout/basic.html" %}
{% block content %}

<!-- Â§ñÈÉ®CSS -->
<link rel="stylesheet" href="/public/typing.css">

<div class="row">
  <div class="medium-12 columns">
    <!-- „Çø„Ç§„Éî„É≥„Ç∞Êú¨‰Ωì -->
    <div class="section">
      <div class="section__header">
        <h1 class="section__title">{{ _('Typing Practice') }}</h1>
      </div>

      <div class="section__body typing-wrap">
        <!-- üîß „Åì„Åì„Åã„ÇâÊñ∞HUD -->
        <div class="hud-deck">
          <!-- Áô∫Èü≥„Éà„Ç∞„É´ÔºàÂ∑¶Ôºâ -->
          <div class="badge-card" id="tts-card" title="Áô∫Èü≥„ÅÆON/OFF">
            <label class="toggle">
              <input id="tts-toggle" type="checkbox" checked>
              <span class="toggle-slider"></span>
            </label>
            <span class="badge-title">üîä Áô∫Èü≥</span>
          </div>

          <!-- ÊÆã„ÇäÂçòË™ûÊï∞ÔºàÂè≥Ôºâ -->
          <div class="badge-card" id="left-card">
            <span class="badge-title">Left</span>
            <span id="hud-remaining" class="badge-count">- / -</span>
          </div>
        </div>
        <!-- üîß „Åì„Åì„Åæ„ÅßÊñ∞HUD -->

        <!-- ÂçòË™ûË°®Á§∫ -->
        <div id="word-display" class="typing-word"></div>

        <!-- Êó•Êú¨Ë™ûË®≥ -->
        <div id="meaning-display" class="typing-meaning"></div>

        <!-- ÁµÇ‰∫ÜÁîªÈù¢ -->
        <div id="end-screen" class="typing-end">
          <h2 class="section__title" style="margin-bottom:.25rem;">{{ _('Finished!') }}</h2>
          <div class="typing-end__score">
            WPM: <span id="final-wpm">0</span>
          </div>
          <form id="score-form" method="post" action="/typing" style="margin-top:.5rem;">
            <input type="hidden" name="score" id="score-input">
            <button type="submit" class="rounded primary button">{{ _('Save score') }}</button>
          </form>
          <div style="margin-top:.5rem; color:#6b7280; font-size:.9rem;">
            <span>Chars: <span id="final-chars">0</span></span> ¬∑
            <span>Time: <span id="final-time">0.0</span>s</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Â±•Ê≠¥„Ç´„Éº„Éâ -->
    <div class="section">
      <div class="history-card">
        <div class="history-header">
          <h2 class="history-title">{{ _('History') }}</h2>
        </div>
        <div>
          {% if history and history.length %}
          <table class="history-table">
            <thead>
              <tr>
                <th>{{ _('Date') }}</th>
                <th>WPM</th> <!-- „Ç¢„ÇØ„Ç∑„Éß„É≥„ÇÇ„Åì„ÅÆÂàó„Å´ÂÖ•„Çå„Çã -->
              </tr>
            </thead>
            <tbody id="history-body">
              {% for h in history %}
              <tr>
                <td class="js-date">{{ h.createdAt }}</td>
                <td>
                  <span class="wpm-badge">{{ h.score }}</span>
                  <span class="history-actions">
                    <!-- „Éï„Ç©„Éº„É†„ÅßÂâäÈô§ÔºàJS‰∏çË¶ÅÔºâ -->
                    <form method="post" action="/typing/delete" style="display:inline;">
                      <input type="hidden" name="id" value="{{ h._id }}">
                      <button type="submit" class="btn btn--ghost-danger">
                        <span class="icon-trash"></span> Delete
                      </button>
                    </form>
                  </span>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          {% else %}
          <div class="history-empty">„Åæ„Å†Â±•Ê≠¥„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>
          {% endif %}
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Â§ñÈÉ®JS -->
<script>
  // „Çµ„Éº„Éê„ÉºÂÅ¥„Åã„Çâ„Éá„Éº„ÇøÂèó„ÅëÂèñ„Çä
  const items = {{ words | safe }};
</script>
<script src="/public/typing.js"></script>

{% endblock %}